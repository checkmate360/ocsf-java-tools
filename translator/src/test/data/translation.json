{
  "when": "datamodels contains 'Authentication'",

  "rules": [

    // ---
    // --- Authentication data model
    // ---

    {
      "version": {
        "desc": "Set the event schema version",
        "@value": "1.0.0"
      }
    },
    {
      "category_id": {
        "desc": "Set the event category_id to Activity(1)",
        "@value": 1
      }
    },
    {
      "class_id": {
        "desc": "Set the event class_id to User Session Activity(400)",
        "@value": 400
      }
    },
    {
      "outcome_id": {
        "desc": "Set the event outcome_id to user Logon(1)",
        "@value": 1
      }
    },
    {
      "severity_id": {
        "desc": "Set the event severity_id to Informational(1)",
        "@value": 1
      }
    },

    {
      "_tenant": {
        "@move": "customer_uid"
      }
    },
    {
      "_time": {
        "@move": {
          "name": "time",
          "type": "timestamp",
          "default": null
        }
      }
    },
    {
      "signature_id": {
        "@move": "ref_event_uid"
      }
    },
    {
      "signature": {
        "@move": "ref_event_name"
      }
    },

    // move and typecast to integer
    {
      "some_id": {
        "@move": "id",
        "type": "integer"
      }
    },

    // --- global, across object, rename/move: process.user_name -> process_user
    {
      "process.user_name": {
        "@move": "process_user"
      }
    },
    // ---
    // --- embedded object operations modify the data within the selected object
    // ---
    {
      "actor": [
        // rename embedded attribute: actor.user -> actor.user_obj
        {
          "user": {
            "@move": "user_obj"
          }
        },
        // rename embedded attribute: actor.file.directory -> actor.file.folder (using alternative style)
        {
          "file": [
            {
              "directory": {
                "@move": {
                  "name": "folder"
                }
              }
            },
            // add a new attribute
            {
              "bad_file": {
                "@value": true
              }
            },
            // rename and change the type
            {
              "file_id": {
                "@move": {
                  "name": "uid",
                  "type": "string"
                }
              }
            }
          ]
        },
        // remove embedded attribute: actor.session_id
        {
          "session_id": {
            "@remove": true
          }
        }
      ]
    },

    // move process file attributes to process.file object
    {
      "process": [
        {
          "path": {
            "@move": "file.path"
          }
        },
        {
          "size": {
            "@move": "file.size"
          }
        },
        {
          "sha2": {
            "@move": "file.sha2"
          }
        }
      ]
    }
  ]
}
